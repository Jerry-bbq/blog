<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>原型和原型链 | Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/logo.png">
    <meta name="description" content="前端博客">
    
    <link rel="preload" href="/blog/assets/css/0.styles.a6713fc6.css" as="style"><link rel="preload" href="/blog/assets/js/app.ee91e132.js" as="script"><link rel="preload" href="/blog/assets/js/2.b6def683.js" as="script"><link rel="preload" href="/blog/assets/js/35.69269e12.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.9bb895b9.js"><link rel="prefetch" href="/blog/assets/js/100.8bd80bfa.js"><link rel="prefetch" href="/blog/assets/js/101.3d6a3bd5.js"><link rel="prefetch" href="/blog/assets/js/102.036e5454.js"><link rel="prefetch" href="/blog/assets/js/103.bbba3319.js"><link rel="prefetch" href="/blog/assets/js/104.c1b06d40.js"><link rel="prefetch" href="/blog/assets/js/105.ef178b45.js"><link rel="prefetch" href="/blog/assets/js/106.7988269e.js"><link rel="prefetch" href="/blog/assets/js/107.dc543871.js"><link rel="prefetch" href="/blog/assets/js/108.69b84df6.js"><link rel="prefetch" href="/blog/assets/js/109.e694c0ca.js"><link rel="prefetch" href="/blog/assets/js/11.5aa6b58c.js"><link rel="prefetch" href="/blog/assets/js/110.f977fe2f.js"><link rel="prefetch" href="/blog/assets/js/111.a85e2f60.js"><link rel="prefetch" href="/blog/assets/js/112.05f5ec5b.js"><link rel="prefetch" href="/blog/assets/js/113.ca16d6f0.js"><link rel="prefetch" href="/blog/assets/js/114.afb5f7bc.js"><link rel="prefetch" href="/blog/assets/js/115.adc5af18.js"><link rel="prefetch" href="/blog/assets/js/116.7909c23f.js"><link rel="prefetch" href="/blog/assets/js/117.bf7662e5.js"><link rel="prefetch" href="/blog/assets/js/118.6ad57043.js"><link rel="prefetch" href="/blog/assets/js/119.21820780.js"><link rel="prefetch" href="/blog/assets/js/12.1457e5b0.js"><link rel="prefetch" href="/blog/assets/js/120.0e07814f.js"><link rel="prefetch" href="/blog/assets/js/121.3d25cc31.js"><link rel="prefetch" href="/blog/assets/js/122.b0187e52.js"><link rel="prefetch" href="/blog/assets/js/123.d20cd754.js"><link rel="prefetch" href="/blog/assets/js/124.82efe3b3.js"><link rel="prefetch" href="/blog/assets/js/125.681f696a.js"><link rel="prefetch" href="/blog/assets/js/13.4c4fff24.js"><link rel="prefetch" href="/blog/assets/js/14.6815a9f0.js"><link rel="prefetch" href="/blog/assets/js/15.28b2b011.js"><link rel="prefetch" href="/blog/assets/js/16.d622c1a4.js"><link rel="prefetch" href="/blog/assets/js/17.36464e6e.js"><link rel="prefetch" href="/blog/assets/js/18.40dfc808.js"><link rel="prefetch" href="/blog/assets/js/19.1353cb16.js"><link rel="prefetch" href="/blog/assets/js/20.51e84ebe.js"><link rel="prefetch" href="/blog/assets/js/21.9a816bb6.js"><link rel="prefetch" href="/blog/assets/js/22.e9959e9a.js"><link rel="prefetch" href="/blog/assets/js/23.de041fe0.js"><link rel="prefetch" href="/blog/assets/js/24.d0ad3bc7.js"><link rel="prefetch" href="/blog/assets/js/25.02f65dca.js"><link rel="prefetch" href="/blog/assets/js/26.dc477e78.js"><link rel="prefetch" href="/blog/assets/js/27.3f7152ed.js"><link rel="prefetch" href="/blog/assets/js/28.2c0e7192.js"><link rel="prefetch" href="/blog/assets/js/29.9d592425.js"><link rel="prefetch" href="/blog/assets/js/3.9140c355.js"><link rel="prefetch" href="/blog/assets/js/30.ccd80458.js"><link rel="prefetch" href="/blog/assets/js/31.8cb8340d.js"><link rel="prefetch" href="/blog/assets/js/32.0c3646db.js"><link rel="prefetch" href="/blog/assets/js/33.81918798.js"><link rel="prefetch" href="/blog/assets/js/34.2e21498e.js"><link rel="prefetch" href="/blog/assets/js/36.07f2b77a.js"><link rel="prefetch" href="/blog/assets/js/37.ed5727be.js"><link rel="prefetch" href="/blog/assets/js/38.49b56f91.js"><link rel="prefetch" href="/blog/assets/js/39.98cbdcd9.js"><link rel="prefetch" href="/blog/assets/js/4.436665c4.js"><link rel="prefetch" href="/blog/assets/js/40.1be549c3.js"><link rel="prefetch" href="/blog/assets/js/41.bedfc450.js"><link rel="prefetch" href="/blog/assets/js/42.09128a48.js"><link rel="prefetch" href="/blog/assets/js/43.a7a7863a.js"><link rel="prefetch" href="/blog/assets/js/44.a456867f.js"><link rel="prefetch" href="/blog/assets/js/45.871f9e32.js"><link rel="prefetch" href="/blog/assets/js/46.f6332e8d.js"><link rel="prefetch" href="/blog/assets/js/47.96a81ea0.js"><link rel="prefetch" href="/blog/assets/js/48.72267b6a.js"><link rel="prefetch" href="/blog/assets/js/49.6afb4a0d.js"><link rel="prefetch" href="/blog/assets/js/5.1da1f2e9.js"><link rel="prefetch" href="/blog/assets/js/50.e519df7e.js"><link rel="prefetch" href="/blog/assets/js/51.7c8d2297.js"><link rel="prefetch" href="/blog/assets/js/52.5513bd3c.js"><link rel="prefetch" href="/blog/assets/js/53.7c76ff81.js"><link rel="prefetch" href="/blog/assets/js/54.076ab583.js"><link rel="prefetch" href="/blog/assets/js/55.40b0e295.js"><link rel="prefetch" href="/blog/assets/js/56.1350c79e.js"><link rel="prefetch" href="/blog/assets/js/57.081cc9d0.js"><link rel="prefetch" href="/blog/assets/js/58.54b7652f.js"><link rel="prefetch" href="/blog/assets/js/59.5785eb19.js"><link rel="prefetch" href="/blog/assets/js/6.b1b3398a.js"><link rel="prefetch" href="/blog/assets/js/60.597688ea.js"><link rel="prefetch" href="/blog/assets/js/61.91a6bf39.js"><link rel="prefetch" href="/blog/assets/js/62.c17aa122.js"><link rel="prefetch" href="/blog/assets/js/63.262ba01f.js"><link rel="prefetch" href="/blog/assets/js/64.3f73a779.js"><link rel="prefetch" href="/blog/assets/js/65.ae1421b7.js"><link rel="prefetch" href="/blog/assets/js/66.d3f5dcb2.js"><link rel="prefetch" href="/blog/assets/js/67.660515ec.js"><link rel="prefetch" href="/blog/assets/js/68.dc7e42a9.js"><link rel="prefetch" href="/blog/assets/js/69.4d3197cf.js"><link rel="prefetch" href="/blog/assets/js/7.ca03f6d9.js"><link rel="prefetch" href="/blog/assets/js/70.f2b05361.js"><link rel="prefetch" href="/blog/assets/js/71.a262386c.js"><link rel="prefetch" href="/blog/assets/js/72.64c55039.js"><link rel="prefetch" href="/blog/assets/js/73.2e976676.js"><link rel="prefetch" href="/blog/assets/js/74.f937db7d.js"><link rel="prefetch" href="/blog/assets/js/75.71394c79.js"><link rel="prefetch" href="/blog/assets/js/76.3a55f0a8.js"><link rel="prefetch" href="/blog/assets/js/77.51dcbe3f.js"><link rel="prefetch" href="/blog/assets/js/78.27f78897.js"><link rel="prefetch" href="/blog/assets/js/79.a7489360.js"><link rel="prefetch" href="/blog/assets/js/8.41ca7a03.js"><link rel="prefetch" href="/blog/assets/js/80.2fec6d75.js"><link rel="prefetch" href="/blog/assets/js/81.c279656e.js"><link rel="prefetch" href="/blog/assets/js/82.5a951e6d.js"><link rel="prefetch" href="/blog/assets/js/83.a35d4afc.js"><link rel="prefetch" href="/blog/assets/js/84.0ff526cc.js"><link rel="prefetch" href="/blog/assets/js/85.26590f6f.js"><link rel="prefetch" href="/blog/assets/js/86.4f246c10.js"><link rel="prefetch" href="/blog/assets/js/87.4293f7f1.js"><link rel="prefetch" href="/blog/assets/js/88.7c983999.js"><link rel="prefetch" href="/blog/assets/js/89.1c0971a5.js"><link rel="prefetch" href="/blog/assets/js/9.bd1924ab.js"><link rel="prefetch" href="/blog/assets/js/90.7770cdf7.js"><link rel="prefetch" href="/blog/assets/js/91.b6754b55.js"><link rel="prefetch" href="/blog/assets/js/92.b8d151f4.js"><link rel="prefetch" href="/blog/assets/js/93.f0f27d1d.js"><link rel="prefetch" href="/blog/assets/js/94.15203e88.js"><link rel="prefetch" href="/blog/assets/js/95.2b3a374d.js"><link rel="prefetch" href="/blog/assets/js/96.bdf18d33.js"><link rel="prefetch" href="/blog/assets/js/97.2b6816c8.js"><link rel="prefetch" href="/blog/assets/js/98.0f5afe48.js"><link rel="prefetch" href="/blog/assets/js/99.4e86492a.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.a6713fc6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link router-link-active">
  FE
</a></div><div class="nav-item"><a href="/blog/job-summary/" class="nav-link">
  JobSummary
</a></div><div class="nav-item"><a href="/blog/audition/" class="nav-link">
  HK-Office
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  Share
</a></div><div class="nav-item"><a href="https://gitee.com/luguanrui/lgr-tools?_from=gitee_search" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lgr-tools
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/luguanrui?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blog/base/" class="nav-link router-link-active">
  FE
</a></div><div class="nav-item"><a href="/blog/job-summary/" class="nav-link">
  JobSummary
</a></div><div class="nav-item"><a href="/blog/audition/" class="nav-link">
  HK-Office
</a></div><div class="nav-item"><a href="/blog/share/" class="nav-link">
  Share
</a></div><div class="nav-item"><a href="https://gitee.com/luguanrui/lgr-tools?_from=gitee_search" target="_blank" rel="noopener noreferrer" class="nav-link external">
  lgr-tools
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/luguanrui?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>原型和原型链</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/base/javascript/prototype-chain.html#创建对象的几种方法" class="sidebar-link">创建对象的几种方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#字面量方法" class="sidebar-link">字面量方法</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#构造函数" class="sidebar-link">构造函数</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#object-create" class="sidebar-link">Object.create()</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#构造函数constructor" class="sidebar-link">构造函数constructor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#特点" class="sidebar-link">特点</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#原型" class="sidebar-link">原型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#原型对象" class="sidebar-link">原型对象</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#原型链" class="sidebar-link">原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#定义-2" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#原型链的查找过程" class="sidebar-link">原型链的查找过程</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#图解" class="sidebar-link">图解</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#instanceof运算符" class="sidebar-link">instanceof运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#案例" class="sidebar-link">案例</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#实现" class="sidebar-link">实现</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#new运算符" class="sidebar-link">new运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#原理-2" class="sidebar-link">原理</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#实现-2" class="sidebar-link">实现</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#继承" class="sidebar-link">继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_1-构造函数-子类构造函数中执行父类构造函数" class="sidebar-link">1. 构造函数：子类构造函数中执行父类构造函数</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_2-原型链-将父类构造函数的实例赋值给子类构造函数的原型" class="sidebar-link">2. 原型链：将父类构造函数的实例赋值给子类构造函数的原型</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_3-组合方式-构造函数-原型链" class="sidebar-link">3. 组合方式：构造函数+原型链</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_4-优化组合方式1-将父类构造函数的原型赋值给子类构造函数的原型" class="sidebar-link">4. 优化组合方式1: 将父类构造函数的原型赋值给子类构造函数的原型</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_5-优化组合方式2-通过object-create" class="sidebar-link">5. 优化组合方式2：通过Object.create()</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#_6-使用es6的extends" class="sidebar-link">6. 使用es6的extends</a></li></ul></li><li><a href="/blog/base/javascript/prototype-chain.html#改变this指向" class="sidebar-link">改变this指向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#call-apply-bind区别" class="sidebar-link">call/apply/bind区别</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#自定义call和apply" class="sidebar-link">自定义call和apply</a></li><li class="sidebar-sub-header"><a href="/blog/base/javascript/prototype-chain.html#自定义bind" class="sidebar-link">自定义bind</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="原型和原型链"><a href="#原型和原型链" class="header-anchor">#</a> 原型和原型链</h1> <p>JavaScript是面向对象编程（Object-oriented programming ，OOP）的语言，OOP的基本思想是在程序里，我们通过使用对象去构建现实世界的模型，把原本很难（或不可）能被使用的功能，简单化并提供出来，以供访问。</p> <h2 id="创建对象的几种方法"><a href="#创建对象的几种方法" class="header-anchor">#</a> 创建对象的几种方法</h2> <h3 id="字面量方法"><a href="#字面量方法" class="header-anchor">#</a> 字面量方法</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// {}</span>
<span class="token keyword">var</span> o1 <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'o1'</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">M</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name <span class="token punctuation">}</span>
<span class="token keyword">var</span> o3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">M</span><span class="token punctuation">(</span><span class="token string">'o3'</span><span class="token punctuation">)</span>

<span class="token comment">// new Object()</span>
<span class="token keyword">var</span> o2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'o2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="object-create"><a href="#object-create" class="header-anchor">#</a> Object.create()</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Object.create(),创建一个对象并继承原型对象</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> o4 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token comment">// o4.__proto__ === p</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Object.create(null) 创建的对象是一个空对象，在该对象上没有继承原型链上的属性或者方法</p></div> <h2 id="构造函数constructor"><a href="#构造函数constructor" class="header-anchor">#</a> 构造函数constructor</h2> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <p>构造函数（constructor）也称之为构造器，功能类似对象模板，一个构造器可以生成任意多个实例，实例对象具有相同的属性和方法，但是不相等</p> <p>在JavaScript中，构造器其实就是一个普通的函数。当使用<strong>new操作符</strong>来作用这个函数时，它就可以被称为构造函数</p> <h3 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h3> <ul><li>首字母大写</li> <li>函数体内部使用<code>this</code>关键字,代表所要生成的对象实例</li> <li>生成对象时，必须使用<code>new</code>操作符</li></ul> <h2 id="原型"><a href="#原型" class="header-anchor">#</a> 原型</h2> <p>JavaScript中每个对象都拥有一个原型对象，对象以其原型为模板、从原型继承方法和属性。</p> <p>每个函数都有一个特殊的属性叫作原型（prototype）,案例如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> doSomething<span class="token punctuation">.</span>prototype <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以看到<code>doSomething</code> 函数有一个默认的原型属性：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span>
    constructor: ƒ doSomething<span class="token punctuation">(</span><span class="token punctuation">)</span>,
    __proto__: <span class="token punctuation">{</span>
        constructor: ƒ Object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hasOwnProperty: ƒ hasOwnProperty<span class="token punctuation">(</span><span class="token punctuation">)</span>
        isPrototypeOf: ƒ isPrototypeOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
        propertyIsEnumerable: ƒ propertyIsEnumerable<span class="token punctuation">(</span><span class="token punctuation">)</span>
        toLocaleString: ƒ toLocaleString<span class="token punctuation">(</span><span class="token punctuation">)</span>
        toString: ƒ toString<span class="token punctuation">(</span><span class="token punctuation">)</span>
        valueOf: ƒ valueOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __defineGetter__: ƒ __defineGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __defineSetter__: ƒ __defineSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __lookupGetter__: ƒ __lookupGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __lookupSetter__: ƒ __lookupSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        get __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">set</span> __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>现在，添加一些属性到 <code>doSomething</code> 的原型上面</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
doSomething<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> doSomething<span class="token punctuation">.</span>prototype <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>结果如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span>
    foo: <span class="token string">&quot;bar&quot;</span>,
    constructor: ƒ doSomething<span class="token punctuation">(</span><span class="token punctuation">)</span>,
    __proto__: <span class="token punctuation">{</span>
        constructor: ƒ Object<span class="token punctuation">(</span><span class="token punctuation">)</span>
        hasOwnProperty: ƒ hasOwnProperty<span class="token punctuation">(</span><span class="token punctuation">)</span>
        isPrototypeOf: ƒ isPrototypeOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
        propertyIsEnumerable: ƒ propertyIsEnumerable<span class="token punctuation">(</span><span class="token punctuation">)</span>
        toLocaleString: ƒ toLocaleString<span class="token punctuation">(</span><span class="token punctuation">)</span>
        toString: ƒ toString<span class="token punctuation">(</span><span class="token punctuation">)</span>
        valueOf: ƒ valueOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __defineGetter__: ƒ __defineGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __defineSetter__: ƒ __defineSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __lookupGetter__: ƒ __lookupGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        __lookupSetter__: ƒ __lookupSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        get __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">set</span> __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>使用<code>new</code>关键字创建一个<code>doSomething</code>的实例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
doSomething<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>foo <span class="token operator">=</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">;</span> <span class="token comment">// add a property onto the prototype</span>
<span class="token keyword">var</span> doSomeInstancing <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
doSomeInstancing<span class="token punctuation">.</span>prop <span class="token operator">=</span> <span class="token string">&quot;some value&quot;</span><span class="token punctuation">;</span> <span class="token comment">// add a property onto the object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> doSomeInstancing <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>结果如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">{</span>
    prop: <span class="token string">&quot;some value&quot;</span>,
    __proto__: <span class="token punctuation">{</span>
        foo: <span class="token string">&quot;bar&quot;</span>,
        constructor: ƒ doSomething<span class="token punctuation">(</span><span class="token punctuation">)</span>,
        __proto__: <span class="token punctuation">{</span>
            constructor: ƒ Object<span class="token punctuation">(</span><span class="token punctuation">)</span>
            hasOwnProperty: ƒ hasOwnProperty<span class="token punctuation">(</span><span class="token punctuation">)</span>
            isPrototypeOf: ƒ isPrototypeOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
            propertyIsEnumerable: ƒ propertyIsEnumerable<span class="token punctuation">(</span><span class="token punctuation">)</span>
            toLocaleString: ƒ toLocaleString<span class="token punctuation">(</span><span class="token punctuation">)</span>
            toString: ƒ toString<span class="token punctuation">(</span><span class="token punctuation">)</span>
            valueOf: ƒ valueOf<span class="token punctuation">(</span><span class="token punctuation">)</span>
            __defineGetter__: ƒ __defineGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
            __defineSetter__: ƒ __defineSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
            __lookupGetter__: ƒ __lookupGetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
            __lookupSetter__: ƒ __lookupSetter__<span class="token punctuation">(</span><span class="token punctuation">)</span>
            get __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token builtin class-name">set</span> __proto__: ƒ __proto__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>可以看到，<code>doSomeInstancing</code>实例的 <code>__proto__</code> 属性就是<code>doSomething</code>函数的<code>prototype</code>,即<code>doSomeInstancing.__proto__ === doSomething.prototype</code>。</p> <ul><li>当访问<code>doSomeInstancing</code>的一个属性的时候，浏览器首先查找<code>doSomeInstancing</code>是否有这个属性</li> <li>如果没有，浏览器就会在<code>doSomeInstancing</code>的<code>__proto__</code>中查找这个属性，也就是到原型对象<code>doSomething.prototype</code>上查找</li> <li>如果也没有找到，则继续在<code>doSomeInstancing</code>的<code>__proto__</code>的<code>__proto__</code>上查找，所有函数的原型属性的 <code>__proto__</code> 就是 <code>window.Object.prototype</code></li> <li>最后，原型链上的所有的<code>__proto__</code>都找完了也没找到该属性，这个属性返回<code>undefined</code></li></ul> <table><thead><tr><th>原型对象</th> <th>说明</th> <th>值</th></tr></thead> <tbody><tr><td>显式原型对象<code>prototype</code></td> <td>所有<strong>函数</strong>都有一个<code>prototype</code>属性</td> <td>对象</td></tr> <tr><td>隐式原型对象<code>__proto__</code></td> <td>所有<strong>实例</strong>都有一个私有属性<code>__proto__</code></td> <td>对象</td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">提示</p> <ul><li>所有<strong>实例</strong>的<code>__proto__</code>属性指向它<strong>构造函数</strong>的原型对象（<code>prototype</code>）</li> <li>根据定义，<code>null</code> 没有原型，并作为这个原型链中的最后一个环节</li> <li><code>__proto__</code>是一个内部属性，不建议对其进行直接操作</li></ul></div> <h2 id="原型对象"><a href="#原型对象" class="header-anchor">#</a> 原型对象</h2> <p>继承成员被定义的地方，被称作为原型对象<code>prototype</code></p> <p>比如，<code>Object</code>的<code>hasOwnProperty</code>、<code>toString</code>,<code>valueOf</code>都是可以继承的方法，但是<code>Object.create()</code>、<code>Object.keys()</code>、<code>Object.values()</code>,则不能被继承</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 继承的属性和方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>

<span class="token punctuation">{</span>
    constructor<span class="token operator">:</span> ƒ <span class="token function">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    hasOwnProperty<span class="token operator">:</span> ƒ <span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    isPrototypeOf<span class="token operator">:</span> ƒ <span class="token function">isPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    propertyIsEnumerable<span class="token operator">:</span> ƒ <span class="token function">propertyIsEnumerable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    toLocaleString<span class="token operator">:</span> ƒ <span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    toString<span class="token operator">:</span> ƒ <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    valueOf<span class="token operator">:</span> ƒ <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __defineGetter__<span class="token operator">:</span> ƒ <span class="token function">__defineGetter__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __defineSetter__<span class="token operator">:</span> ƒ <span class="token function">__defineSetter__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __lookupGetter__<span class="token operator">:</span> ƒ <span class="token function">__lookupGetter__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __lookupSetter__<span class="token operator">:</span> ƒ <span class="token function">__lookupSetter__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">get</span> __proto__<span class="token operator">:</span> ƒ <span class="token function">__proto__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">set</span> __proto__<span class="token operator">:</span> ƒ <span class="token function">__proto__</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 不能被继承的属性和方法</span>
console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span><span class="token parameter">Object</span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
    arguments<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
    assign<span class="token operator">:</span> ƒ <span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    caller<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
    create<span class="token operator">:</span> ƒ <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    defineProperties<span class="token operator">:</span> ƒ <span class="token function">defineProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    defineProperty<span class="token operator">:</span> ƒ <span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    entries<span class="token operator">:</span> ƒ <span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    freeze<span class="token operator">:</span> ƒ <span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fromEntries<span class="token operator">:</span> ƒ <span class="token function">fromEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    getOwnPropertyDescriptor<span class="token operator">:</span> ƒ <span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    getOwnPropertyDescriptors<span class="token operator">:</span> ƒ <span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    getOwnPropertyNames<span class="token operator">:</span> ƒ <span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    getOwnPropertySymbols<span class="token operator">:</span> ƒ <span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    getPrototypeOf<span class="token operator">:</span> ƒ <span class="token function">getPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    is<span class="token operator">:</span> ƒ <span class="token function">is</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    isExtensible<span class="token operator">:</span> ƒ <span class="token function">isExtensible</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    isFrozen<span class="token operator">:</span> ƒ <span class="token function">isFrozen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    isSealed<span class="token operator">:</span> ƒ <span class="token function">isSealed</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    keys<span class="token operator">:</span> ƒ <span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    length<span class="token operator">:</span> <span class="token number">1</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Object&quot;</span>
    preventExtensions<span class="token operator">:</span> ƒ <span class="token function">preventExtensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    prototype<span class="token operator">:</span> <span class="token punctuation">{</span>constructor<span class="token operator">:</span> ƒ<span class="token punctuation">,</span> __defineGetter__<span class="token operator">:</span> ƒ<span class="token punctuation">,</span> __defineSetter__<span class="token operator">:</span> ƒ<span class="token punctuation">,</span> hasOwnProperty<span class="token operator">:</span> ƒ<span class="token punctuation">,</span> __lookupGetter__<span class="token operator">:</span> ƒ<span class="token punctuation">,</span> …<span class="token punctuation">}</span>
    seal<span class="token operator">:</span> ƒ <span class="token function">seal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    setPrototypeOf<span class="token operator">:</span> ƒ <span class="token function">setPrototypeOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    values<span class="token operator">:</span> ƒ <span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    __proto__<span class="token operator">:</span> <span class="token function">ƒ</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h2> <h3 id="定义-2"><a href="#定义-2" class="header-anchor">#</a> 定义</h3> <p><strong>在JavaScript中，每个对象都拥有一个原型对象，对象以其原型为模板、从原型继承方法和属性。原型对象也可能拥有原型，并从中继承方法和属性，一层一层、以此类推。这种关系常被称为原型链</strong>。它解释了为何一个对象会拥有定义在其他对象中的属性和方法</p> <h3 id="原型链的查找过程"><a href="#原型链的查找过程" class="header-anchor">#</a> 原型链的查找过程</h3> <ul><li>当访问一个对象的某个属性时，会先在这个对象本身属性上查找</li> <li>如果没有找到，则会去该对象的<code>__proto__</code>上查找</li> <li>如果还没有找到就会再在<code>__proto__</code>的<code>__proto__</code>中查找,最终会查到<code>Object.prototype</code>上</li> <li>如果没有找到会返回<code>undefined</code></li></ul> <h3 id="图解"><a href="#图解" class="header-anchor">#</a> 图解</h3> <p><img src="/blog/assets/img/constructor.a3e50e8c.png" alt="constructor"></p> <p>构造函数：</p> <ul><li>function Foo()</li> <li>function Object()</li> <li>function Function()</li></ul> <p>总结：</p> <ol><li>所有的实例化对象的<code>__proto__</code>指向 其构造函数的<code>prototype</code></li> <li>所有普通的对象和构造函数的<code>prototype</code>的<code>__proto__</code>都指向<code>Object.prototype</code></li> <li>所有函数（包括构造函数）都是<code>Function</code>的实例，所以<code>__proto__</code>都指向<code>Function.prototype</code></li></ol> <p>过程：</p> <ul><li>定义一个构造函数Foo，并实例化为f1，从实例f1上查找某个属性或方法，会该实例本身上查找属性或方法，</li> <li>如果没有找到，则从实例的__proto__上查找，也就是实例f1的构造函数Foo的原型对象上（即Foo.prototype）查找</li> <li>如果没有找到，则继续从实例f1的__proto__的__proto__上查找，也就是实例f1的构造函数的原型的原型上查找，即Foo.prototype.__proro__上查找，</li> <li>如果没有找到，则继续从实例f1的__proto__的__proto__的__proto__上查找，即实例f1的构造函数的原型的原型的原型上查找，即Foo.prototype.<strong>proro</strong>.__proro__上，最后找到Object.prototype上，</li> <li>如果还是没有，则找到null</li> <li>对象以此类推</li></ul> <h2 id="instanceof运算符"><a href="#instanceof运算符" class="header-anchor">#</a> instanceof运算符</h2> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <p>检测构造函数的 <code>prototype</code> 属性是否出现在某个实例对象的原型链上，是则返回true，否则返回false</p> <h3 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Car</span><span class="token punctuation">(</span><span class="token parameter">make<span class="token punctuation">,</span> model<span class="token punctuation">,</span> year</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>make <span class="token operator">=</span> make<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>model <span class="token operator">=</span> model<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>year <span class="token operator">=</span> year<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> auto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token string">'Honda'</span><span class="token punctuation">,</span> <span class="token string">'Accord'</span><span class="token punctuation">,</span> <span class="token number">1998</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// auto.__proto__ === Car.prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>auto <span class="token keyword">instanceof</span> <span class="token class-name">Car</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// auto.__proto__.__proto__ === Object.prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>auto <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="实现"><a href="#实现" class="header-anchor">#</a> 实现</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 模拟instanceof操作符
 * 
 * 检测构造函数的`prototype`属性是否出现在某个实例对象的原型链上，是则返回true，否则返回false
 * 1. 获取实例的原型`proto`
 * 2. 获取构造函数的原型`prototype`
 * 3. 使用while循环
 *    1）如果实例的原型proto为null，说明没有找到，返回 false
 *    2）如果实例的原型proto等于构造函数的原型prototype，说明找到了，返回 true
 *    3）循环条件是：通过原型链，依次比较构造函数的原型是否与实例的原型相等
 * 
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">_instanceof</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> proto <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
  <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>proto <span class="token operator">===</span> prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    proto <span class="token operator">=</span> proto<span class="token punctuation">.</span>__proto__
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试</span>
<span class="token function">_instanceof</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Array<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">_instanceof</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Object<span class="token punctuation">)</span> <span class="token comment">// true</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="new运算符"><a href="#new运算符" class="header-anchor">#</a> new运算符</h2> <p>创建一个对象的实例：<code>new [constructor]</code></p> <ol><li>无 return</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>结果为：{ age: 111 }</p> <ol start="2"><li>return 对象类型数据</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">&quot;return 对象&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>结果为：{ type: &quot;return 对象&quot; }</p> <ol start="3"><li>return 基本类型数据</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token number">333</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>结果为：{ age: 333 }</p> <p>总结：</p> <ul><li>如果构造函数显式返回对象类型，则直接返回这个对象</li> <li>如果构造函数没有显式返回对象类型（返回基本数据类型或者直接不返回），则返回最开始创建的对象</li></ul> <div class="custom-block warning"><p class="custom-block-title">提示</p> <p>如果构造函数是箭头函数，因为箭头函数中没有<code>[[Constructor]]</code>方法，不能使用<code>new</code>调用，会报错。</p></div> <h3 id="原理-2"><a href="#原理-2" class="header-anchor">#</a> 原理</h3> <ol><li>创建一个空对象实例</li> <li>将实例的<code>__proto__</code>指向构造函数的原型<code>constructor.prototype</code>（继承构造函数的原型对象）</li> <li>执行构造函数，绑定<code>this</code>指向实例，实例作为<code>this</code>的上下文）</li> <li>如果构造函数的执行结果是一个对象，则返回这个对象，否则，返回实例对象</li></ol> <h3 id="实现-2"><a href="#实现-2" class="header-anchor">#</a> 实现</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 模拟new操作符
 * 1. 创建一个新对象obj
 * 2. 继承构造函数的原型对象fn.prototype
 * 3. 执行构造函数，并将this指向新创建的对象obj
 * 4. 判断执行构造函数返回的结果res，如果res是一个对象，则返回这个res，否则返回创建的对象obj
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">_new</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> <span class="token operator">...</span>arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arg<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> res <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> res
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> obj
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 验证</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">)</span>
o <span class="token keyword">instanceof</span> <span class="token class-name">C</span> <span class="token comment">// 判断实例o是不是M构造函数的实例,返回true</span>
o <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> 
o<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> <span class="token constant">C</span> <span class="token comment">// 实例o的原型对象是否等于构造函数C</span>
<span class="token class-name">C</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">walk</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'walk'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token comment">// 在构造函数C的原型上增加一个方法walk</span>
o<span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h2> <p>复制父类的方法和属性来重写子类的原型对象</p> <h3 id="_1-构造函数-子类构造函数中执行父类构造函数"><a href="#_1-构造函数-子类构造函数中执行父类构造函数" class="header-anchor">#</a> 1. 构造函数：子类构造函数中执行父类构造函数</h3> <p>子类构造函数中执行父类构造函数（<code>Parent.call(this)</code>）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Parent'</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用父类，父类函数执行，绑定this</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// 或者使用apply，this 指向 Child</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child'</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>结果：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;Parent&quot;</span>
    type<span class="token operator">:</span> <span class="token string">&quot;Child&quot;</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>Prototype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        constructor<span class="token operator">:</span> ƒ Child()
        <span class="token punctuation">[</span><span class="token punctuation">[</span>Prototype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> Object
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">缺点</p> <ol><li>只能继承父类构造函数通过<code>this</code>声明的属性/方法。不能继承父类构造函数原型<code>prototype</code>上的属性/方法</li> <li>父类方法无法复用。每次实例化子类，都要执行父类函数。重新声明父类所定义的方法，无法复用</li></ol></div> <h3 id="_2-原型链-将父类构造函数的实例赋值给子类构造函数的原型"><a href="#_2-原型链-将父类构造函数的实例赋值给子类构造函数的原型" class="header-anchor">#</a> 2. 原型链：将父类构造函数的实例赋值给子类构造函数的原型</h3> <p>方法：将父类构造函数的实例赋值给子类构造函数的原型对象（<code>Child.prototype = new Parent()</code>）</p> <p>原因：子类Child.prototype赋值父类的实例new Parent()，当子类实例化时，<code>子类实例的__proto__</code>就等于<code>子类构造函数的prototype</code>，<code>子类实例的__proto__</code>等于<code>父类的实例</code>，因此实现了继承</p> <p>作用：弥补通过构造函数继承的缺点（继承不了父类构造函数原型对象<code>（Parent.prototype）</code>上的属性和方法）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Parent'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类函数原型指向构造函数的实例</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 缺点：改变s1原型对象上的属性和方法会影响到s2对象，</span>
<span class="token comment">// 原因是s1和s2的__proto__的指向相同（s1.__proto__ === s2.__proto__）</span>
<span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>play<span class="token punctuation">,</span>s2<span class="token punctuation">.</span>play<span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>play<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>play<span class="token punctuation">,</span>s2<span class="token punctuation">.</span>play<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>结果：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>Child
    type<span class="token operator">:</span> <span class="token string">&quot;Child&quot;</span>
    <span class="token punctuation">[</span><span class="token punctuation">[</span>Prototype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> Parent
        name<span class="token operator">:</span> <span class="token string">&quot;Parent&quot;</span>
        play<span class="token operator">:</span> (<span class="token number">3</span>) <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
        <span class="token punctuation">[</span><span class="token punctuation">[</span>Prototype<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> Object
            constructor<span class="token operator">:</span> ƒ Parent()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">缺点</p> <ol><li>如果实例化两个子类构造函数，其中一个子类构造函数的原型上的方法和属性改变，另一个实例也会相应改变</li> <li>创建子类实例时，无法向父类构造函数传参</li></ol></div> <h3 id="_3-组合方式-构造函数-原型链"><a href="#_3-组合方式-构造函数-原型链" class="header-anchor">#</a> 3. 组合方式：构造函数+原型链</h3> <p>通过原型链继承来将this、prototype上的属性和方法继承到子类的原型对象上。借用构造函数来继承父类通过this声明的属性和方法在之子类的实例属性上</p> <p>方法：</p> <ul><li>在子类构造函数中执行父类构造函数</li> <li>然后将父类的构造函数的实例 赋值给 子类的原型对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Parent'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child'</span>
<span class="token punctuation">}</span>

<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 测试</span>
<span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span>play<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>play<span class="token punctuation">,</span>s2<span class="token punctuation">.</span>play<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">缺点</p> <ol><li>父类构造函数执行了两次,造成一定的性能问题</li> <li>因调用两次父类，导致父类通过<code>this</code>声明的属性和方法被生成两份的问题</li> <li>原型链上下文丢失，子类和父类通过<code>prototype</code>声明的属性和方法都存在与子类<code>prototype</code>上</li></ol></div> <h3 id="_4-优化组合方式1-将父类构造函数的原型赋值给子类构造函数的原型"><a href="#_4-优化组合方式1-将父类构造函数的原型赋值给子类构造函数的原型" class="header-anchor">#</a> 4. 优化组合方式1: 将父类构造函数的原型赋值给子类构造函数的原型</h3> <p>方法：</p> <ul><li>子类构造函数中执行父类构造函数</li> <li>然后将父类构造函数的原型对象赋值给子类构造函数的原型对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Parent'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child'</span>
<span class="token punctuation">}</span>

<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype

<span class="token comment">// 测试</span>
<span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s2 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span> <span class="token comment">// 子类实例的构造函数是`Parent`，而不是`Child`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="custom-block danger"><p class="custom-block-title">缺点</p> <p>区分不了一个对象是子类的实例化还是父类的实例化</p></div> <h3 id="_5-优化组合方式2-通过object-create"><a href="#_5-优化组合方式2-通过object-create" class="header-anchor">#</a> 5. 优化组合方式2：通过Object.create()</h3> <p>方法：</p> <ul><li>在子类构造函数中执行父类构造函数</li> <li>然后创建父类构造函数的实例继承赋值给子类构造函数的原型对象</li> <li>最后将子类构造函数赋值给子类构造函数的原型对象的constructor</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Parent'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'Child'</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child

<span class="token comment">// 测试</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">,</span> s <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span> <span class="token comment">// 子类实例的构造函数是`Child`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_6-使用es6的extends"><a href="#_6-使用es6的extends" class="header-anchor">#</a> 6. 使用es6的extends</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
    <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment">// Parent.call(this, value)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
child <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="改变this指向"><a href="#改变this指向" class="header-anchor">#</a> 改变this指向</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// demo</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>xxx <span class="token operator">=</span> <span class="token number">3</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>                     <span class="token comment">// 1,2,Window</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span>  

<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>m<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span>

<span class="token comment">// 改变this指向</span>
<span class="token comment">// call参数平铺</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token comment">// 1,2, obj</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>      <span class="token comment">// 1,2, Window</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token comment">// 1,2, Window</span>
<span class="token comment">// apply参数为数组</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>         <span class="token comment">// 1,2, obj</span>

<span class="token comment">// bind返回一个新的函数，为了看到结果，我们去执行下函数</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>            <span class="token comment">// 3,4, obj</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>         <span class="token comment">// 5,3, obj</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>      <span class="token comment">// 5,6, obj</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="call-apply-bind区别"><a href="#call-apply-bind区别" class="header-anchor">#</a> call/apply/bind区别</h3> <table><thead><tr><th>api</th> <th>函数是否执行</th> <th>this指向</th> <th>参数</th></tr></thead> <tbody><tr><td>call</td> <td>执行</td> <td>指向第一个参数</td> <td>call(obj, param1,param1...)，参数列表</td></tr> <tr><td>apply</td> <td>执行</td> <td>指向第一个参数</td> <td>apply(obj, [param1,param1...])，参数是数组</td></tr> <tr><td>bind</td> <td>返回绑定this之后的新的函数 <br>（新函数内部会调用原来的函数）</td> <td>指向第一个参数</td> <td>bind(obj, param1,param1...)，参数可以分为多次传入</td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">提示</p> <p>如果 obj 为 <code>undefined</code> 或 <code>null</code>，<code>this</code> 指向 <code>Window</code>对象</p> <p>bind()会返回一个新的函数，如果这个返回的新的函数作为构造函数创建一个新的对象，那么此时 this 不再指向传入给 bind 的第一个参数，而是指向用 new 创建的实例</p></div> <h3 id="自定义call和apply"><a href="#自定义call和apply" class="header-anchor">#</a> 自定义call和apply</h3> <p>实现思路：</p> <ol><li>给obj添加一个临时方法，方法名任意，值为当前函数</li> <li>通过obj调用这个临时方法，并将接收的参数传入</li> <li>删除obj上的这个临时方法属性</li> <li>返回方法的执行结果</li></ol> <p>call():</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 模拟call
 * 语法：function.call(thisArg, arg1, arg2, ...)
 * 1. 改变this指向第一个参数，如果为undefined或null，this指向window对象
 * 2. 执行函数
 * 
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_call</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理obj是undefined或者null的情况</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj <span class="token operator">=</span> window
  <span class="token punctuation">}</span>
  obj <span class="token operator">=</span> obj <span class="token operator">||</span> window

  <span class="token comment">// 给obj添加一个方法fn,赋值this</span>
  obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token comment">// 执行fn方法, 传入args参数, 拿到返回值res</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token comment">// 删除fn</span>
  <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn
  <span class="token comment">// 返回res</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>apply():</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 模拟apply
 * 语法：func.apply(thisArg, [argsArray])
 * 1. 改变this指向第一个参数，如果为undefined或null，this指向window对象
 * 2. 执行函数
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_apply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> argsArr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 处理obj是undefined或者null的情况</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj <span class="token operator">=</span> window
  <span class="token punctuation">}</span>
  <span class="token comment">// obj = obj || window</span>

  <span class="token comment">// 给obj添加一个方法fn，赋值this</span>
  obj<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token comment">// 执行fn, 传入参数, 得到返回值res</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>argsArr<span class="token punctuation">)</span>
  <span class="token comment">// 删除fn</span>
  <span class="token keyword">delete</span> obj<span class="token punctuation">.</span>fn
  <span class="token comment">// 返回res</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="自定义bind"><a href="#自定义bind" class="header-anchor">#</a> 自定义bind</h3> <p>实现思路：</p> <ol><li>返回一个新函数</li> <li>在新函数内部通过原函数对象的<code>call</code>方法来执行原函数，指定<code>this</code>为<code>obj</code>，指定参数为bind调用的参数和后面新函数调用的参数</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 模拟bind
 * 语法：function.bind(thisArg[, arg1[, arg2[, ...]]])
 * 1. 改变this指向，函数不执行
 */</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_bind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 返回一个新函数</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用原来函数, 指定this为obj, 参数列表由args和args2依次组成</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>args2<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-11-05 16:31:47</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.ee91e132.js" defer></script><script src="/blog/assets/js/2.b6def683.js" defer></script><script src="/blog/assets/js/35.69269e12.js" defer></script>
  </body>
</html>
